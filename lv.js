function main(){var t=20,a=20,n=30,e=40,d=960-e-a,i=500-t-n,c=d3.scaleBand().range([0,d]).padding(.1),o=d3.scaleLinear().range([i,0]),s=d3.select("body").append("svg").attr("width",d+e+a).attr("height",i+t+n).append("g").attr("transform","translate("+e+","+t+")");d3.json("db.json").then(function(t){for(v in f=[],t.d)r={},r.c=v,r.p=t.d[v].p,f.push(r);c.domain(f.map(function(t){return t.c})),o.domain([0,d3.max(f,function(t){return t.p})]),s.selectAll(".bar").data(f).enter().append("rect").attr("class","bar").attr("x",function(t){return c(t.c)}).attr("width",c.bandwidth()).attr("y",function(t){return o(t.p)}).attr("height",function(t){return i-o(t.p)}).on("click",function(t){gt(t.c)}),s.append("g").attr("transform","translate(0,"+i+")").call(d3.axisBottom(c)),s.append("g").call(d3.axisLeft(o))})}function gt(o){d3.json("dp.json").then(function(t){var a=[t.d[o].y,t.d[o].x],n=Math.min(960,500)/2,r=d3.scaleOrdinal().range(["#98abc5","#8a89a6","#7b6888"]),e=d3.arc().outerRadius(n-10).innerRadius(0),d=d3.arc().outerRadius(n-40).innerRadius(n-40),i=d3.pie().sort(null).value(function(t){return t}),c=d3.select("body").append("svg").attr("width",960).attr("height",500).append("g").attr("transform","translate(480,250)").selectAll(".arc").data(i(a)).enter().append("g").attr("class","arc");c.append("path").attr("d",e).style("fill",function(t){return r(t.data)}),c.append("text").attr("transform",function(t){return"translate("+d.centroid(t)+")"}).attr("dy",".35em").text(function(t){return t.data})})}window.onload=function(){main()};
